#!/bin/sh

# Pre-commit hook: Run lint, type-check, and tests before committing
# This catches TypeScript errors and test failures before they reach CI/Vercel

echo "ğŸ” Running pre-commit checks..."

# Run lint
echo "ğŸ“‹ Linting..."
pnpm run lint || {
  echo "âŒ Lint failed. Please fix the errors and try again."
  exit 1
}

# Run type-check
echo "ğŸ”· Type checking..."
pnpm run type-check || {
  echo "âŒ Type check failed. Please fix the errors and try again."
  exit 1
}

# Run tests (fast subset for pre-commit)
echo "ğŸ§ª Running tests..."
cd apps/web && pnpm test -- --testPathPattern="schema-sync|unit" --passWithNoTests || {
  echo "âŒ Tests failed. Please fix the errors and try again."
  exit 1
}

echo "âœ… All pre-commit checks passed!"
